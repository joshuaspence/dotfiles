# Don't redefine this function.
command -v monitor_traffic >/dev/null && return

# Check for the prerequisite functions.
command -v ngrep >/dev/null || return 1


##
# Takes JSON on STDIN and prints the value of a given path on STDOUT.
#
# @param [String] The keys to access the JSON data. Keys are separated by
#                 spaces.
#
# @link https://github.com/fnichol/bashrc/blob/master/bashrc
#
json_value() {
    if [ -z $1 ]; then
        echo "Usage: json_value <key1> <key2> ... <keyN>" >&2
        return 1
    fi

    local keys=
    for key in $@; do
        keys="${keys}['${key}']"
    done
    unset key

    python -c 'import sys; import json; j = json.loads(sys.stdin.read()); print j'$keys';'
}

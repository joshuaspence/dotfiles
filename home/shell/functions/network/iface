# Don't redefine this function.
command -v iface >/dev/null && return

# Check for the prerequisite functions.
(
    command -v awk >/dev/null &&
    command -v grep >/dev/null &&
    command -v netstat >/dev/null &&
    command -v uname >/dev/null
) || return 1

##
# Get the primary network interface.
#
# @link @todo
#
iface() {
    case $(uname -s) in
        Darwin)
            netstat -nr | grep ^default | grep -v 'link#' | awk '{print $6}'
            ;;
        OpenBSD)
            netstat -nr | grep ^default | awk '{print $8}'
            ;;
        Linux)
            netstat -nr | grep ^0\.0\.0\.0 | awk '{print $8}'
            ;;
        SunOS)
            local def_gateway=$(netstat -nr | grep ^default | awk '{print $2}')
            route get $def_gateway | \ grep '^[ ]*interface:' | awk '{print $2}'
            ;;
        *)
            echo "Could not determine primary network interface" >&2
            return 1
            ;;
    esac
}

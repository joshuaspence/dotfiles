#!/bin/bash

if ! command -v whenever >/dev/null; then
	echo "`whenver` is not installed" >&2
	echo "Try running `gem install whenever`" >&2
	exit 1
fi

schedule=$(readlink -f $(dirname $0)/../cron/config/schedule.rb)
if [[ ! -f $schedule ]]; then
	echo "Schedule file does not exist: '$schedule'" >&2
	exit 2
elif [[ ! -r $schedule ]]; then
	echo "Schedule file cannot be read: '$schedule'" >&2
	exit 3
fi

whenever -w -f $schedule
exit $?
